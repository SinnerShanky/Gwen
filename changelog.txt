Added Pre-Post options
Added from and to year options
Refactored code
Various improvements and fixes.